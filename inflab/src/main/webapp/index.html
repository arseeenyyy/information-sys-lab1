<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Dragon App - Эхо-тест</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios@1.6.7/dist/axios.min.js"></script>
    <style>
        body {
            font-family: sans-serif;
            max-width: 600px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        input, button {
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-size: 1rem;
        }
        .response {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f5f5f5;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <div id="app">
        <h1>Эхо-сервер WildFly</h1>

        <div>
            <input
                type="text"
                v-model="message"
                placeholder="enter:"
                @keyup.enter="sendMessage"
                size="50">
            <br>
            <button @click="sendMessage" :disabled="!message">
                Отправить
            </button>
        </div>

        <div v-if="response" class="response">
            <h3>Ответ сервера:</h3>
            <p><strong>Исходное сообщение:</strong> {{ response.originalMessage }}</p>
            <p><strong>echo:</strong> {{ response.echoedMessage }}</p>
        </div>

        <div v-if="error" style="color: red; margin-top: 1rem;">
            Ошибка: {{ error }}
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    message: '', 
                    response: null, 
                    error: null 
                }
            },
            methods: {
                async sendMessage() {
                    this.error = null;
                    this.response = null;

                    try {
                        const url = 'http://localhost:8080/inflab/echo';
                        const config = {
                            headers: { 'Content-Type': 'application/json' }
                        };

                        const result = await axios.post(url, this.message, config);

                        this.response = result.data;
                        this.message = '';

                    } catch (err) {
                        console.error('Ошибка при отправке:', err);
                            this.error = err.message;
                    }
                }
            }
        }).mount('#app'); 
    </script>
</body>
</html>